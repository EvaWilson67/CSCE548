# Hosting Overview

Platform: Render (Cloud PaaS)

Service:
  - Spring Boot REST API
  - Deployed via Docker container
  - Public endpoint: https://csce548.onrender.com/api/plants

Database:
  - PostgreSQL (Render Managed Database)
  - Accessed via JDBC
  - Environment variables used for credentials

Testing:
  - ConsoleApp demonstrates full CRUD lifecycle.

I will switch hosts in the future. I decided to use Render because they had a postgres host but it will be deleted in a month...

# How to Run the Plant Tracker Service

====================================
1. Running Locally (Development)
====================================

Prerequisites:
- Java 17+
- Maven
- PostgreSQL installed locally

Step 1: Create a local PostgreSQL database

Open SQL Shell (psql):

CREATE DATABASE plantdb;

Connect to it:

\c plantdb

Run the table creation script:

\i db_creation_postgres.sql

Step 2: Start Spring Boot Application

From project root:

mvn clean package
mvn spring-boot:run

Service runs at:
http://localhost:8080

Test endpoint:
http://localhost:8080/api/plants


====================================
2. Running in the Cloud (Render)
====================================

The application is deployed on Render using a Docker-based Web Service
and a managed PostgreSQL database.

Public Service URL:
https://csce548.onrender.com


------------------------------------
Deployment Steps
------------------------------------

1. Push the project to GitHub.

2. Create a new Web Service on Render:
   - Environment: Docker
   - Root Directory: (project folder)
   - Dockerfile Path: Dockerfile

3. Create a PostgreSQL database on Render:
   - Click "New" â†’ PostgreSQL
   - Choose region
   - Wait for provisioning
   - Copy:
       Host
       Port (5432)
       Database name
       Username
       Password

4. Configure environment variables in the Web Service:

   PLANTDB_URL = jdbc:postgresql://<HOST>:5432/<DATABASE>
   PLANTDB_USER = <USERNAME>
   PLANTDB_PASS = <PASSWORD>

5. Redeploy the service.


------------------------------------
Creating Tables Using SQL Shell
------------------------------------

After the database is created on Render, tables must be created manually.

Step 1: Open SQL Shell (psql) locally.

Step 2: Connect to the Render PostgreSQL database.

When prompted in SQL Shell:

Server:
<Render Host>

Database:
<Render Database Name>

Port:
5432

Username:
<Render Username>

Password:
<Render Password>

After successful connection, you should see:

planttracker_db=>

Step 3: Run the table creation SQL.

Paste the following:

CREATE TABLE IF NOT EXISTS Plant (
  Plant_ID SERIAL PRIMARY KEY,
  Name VARCHAR(100) NOT NULL,
  Type VARCHAR(100) NOT NULL,
  Height DECIMAL(6,2),
  DateAcquired DATE,
  location_name VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS Care (
  Plant_ID INT NOT NULL,
  LastSoilChange DATE,
  LastWatering DATE,
  PRIMARY KEY (Plant_ID),
  FOREIGN KEY (Plant_ID)
    REFERENCES Plant(Plant_ID)
    ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS Information (
  Plant_ID INT NOT NULL,
  FromAnotherPlant BOOLEAN DEFAULT FALSE,
  SoilType VARCHAR(100),
  PotSize VARCHAR(50),
  WaterGlobeRequired BOOLEAN DEFAULT FALSE,
  PRIMARY KEY (Plant_ID),
  FOREIGN KEY (Plant_ID)
    REFERENCES Plant(Plant_ID)
    ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS Location (
  Plant_ID INT NOT NULL,
  location_name VARCHAR(100) NOT NULL,
  LightLevel VARCHAR(50),
  PRIMARY KEY (Plant_ID, location_name),
  FOREIGN KEY (Plant_ID)
    REFERENCES Plant(Plant_ID)
    ON DELETE CASCADE
);

Step 4: Verify tables were created:

\dt

You should see:
  plant
  care
  information
  location

After this, the REST endpoints are fully functional.


====================================
3. Running the Console Test Client
====================================

The console application tests full CRUD functionality for the business, DAO, and service

When running the service, adjust the defaultLayer to be empty (will work right away, no need to adjust passwords, but may take like 1 minute to load render)

For using the business or DAO, you would need to switch the DbConfig to local host to imput your own password
In addition, you will need to change the defaultLayer to be "bus" or "data" depending on what you want to test

Run using Maven:
mvn compile exec:java


The console client connects to:
https://csce548.onrender.com

To change the URL:

Windows:
setx PLANT_SERVICE_URL "http://localhost:8080"

Mac/Linux:
export PLANT_SERVICE_URL=http://localhost:8080
